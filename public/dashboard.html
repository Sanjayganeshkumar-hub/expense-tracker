<!DOCTYPE html>
<html>
<head>
  <title>Expense Tracker</title>
</head>
<body style="background:#6c6fdc;color:white;font-family:Arial;padding:20px">

<h1>Expense Tracker</h1>
<button onclick="logout()">Logout</button>

<h2>Summary</h2>
<p>Income: ₹<span id="income">0</span></p>
<p>Expense: ₹<span id="expense">0</span></p>
<p>Balance: ₹<span id="balance">0</span></p>

<h2>Add Transaction</h2>
<select id="type">
  <option value="income">Income</option>
  <option value="expense">Expense</option>
</select>
<input id="amount" placeholder="Amount" type="number">
<input id="category" placeholder="Category">
<input id="description" placeholder="Description">
<button onclick="addTx()">Add</button>

<h2>Transactions</h2>
<ul id="list"></ul>

<script>
async function load() {
  const res = await fetch("/transactions");
  const data = await res.json();

  let income = 0, expense = 0;
  document.getElementById("list").innerHTML = "";

  data.forEach(t => {
    if (t.type === "income") income += t.amount;
    else expense += t.amount;

    document.getElementById("list").innerHTML +=
      `<li>${t.type} - ₹${t.amount} (${t.category})</li>`;
  });

  document.getElementById("income").innerText = income;
  document.getElementById("expense").innerText = expense;
  document.getElementById("balance").innerText = income - expense;
}

async function addTx() {
  await fetch("/transactions", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      type: type.value,
      amount: Number(amount.value),
      category: category.value,
      description: description.value
    })
  });
  load();
}

async function logout() {
  await fetch("/logout", { method: "POST" });
  location.href = "/";
}

load();
</script>

</body>
</html>
